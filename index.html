<script>
    const TOTAL_CARDS = 200;
    const GAME_CYCLE = 120; // 120 seconds total per game loop
    
    function syncGame() {
        const now = Math.floor(Date.now() / 1000);
        const cyclePos = now % GAME_CYCLE;
        
        if (cyclePos < 20) {
            showScreen('Selection'); // 20s Countdown for all
            updateTimer(20 - cyclePos);
        } else {
            showScreen('Game');
            startDrawingBalls(cyclePos); // Everyone sees the same ball sequence
        }
    }

    function checkWin(card) {
        // Auto-checks Horizontal, Vertical, Diagonal, and 4 Corners
        if (hasHorizontal() || hasVertical() || hasDiagonal() || hasCorners()) {
            announceWinner(currentUser, selectedCardId); // Shows for 8s
        }
    }
    
    setInterval(syncGame, 1000);
</script>
